<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>test</title>
</head>
<body>
<div id="answer">测试数据<b>test</b></div>
<script>
    function setClipboardText(event) {
        // event.preventDefault();
        // var node = document.createElement('div');
        // node.appendChild(window.getSelection().getRangeAt(0).cloneContents());
        if (event.clipboardData) {
            event.clipboardData.setData("text/html", "<span style='color: red;' class='123'>13</span>");
            event.clipboardData.setData("text/plain", "13sadasd");
        }
    };
    document.addEventListener('copy', function (e) {
        setClipboardText(e);
    });

    document.addEventListener('paste', function (e) {
        let cbd = e.clipboardData;
        let p = false;
        for (let i = 0; i < cbd.items.length; i++) {
            let item = cbd.items[i];
            let cells = {};
            if (item.kind === "string") {
                item.getAsString((str) => {
                    let textDom = document.createElement("head");
                    textDom.innerHTML = str;
                    console.log("48", textDom)
                    // let styleDom = textDom.getElementsByTagName("style")[0];
                    // let tableDom = textDom.getElementsByTagName("table")[0];
                    // textDom.appendChild(styleDom);
                    // textDom.appendChild(tableDom);
                });
            }
        }
    });
</script>
</body>
</html>
