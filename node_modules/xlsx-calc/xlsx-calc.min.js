/*! xlsx-calc 2017-07-29 */
"use strict";(function(){function a(a){return(""+a).length}function b(a){return(""+a).trim()}function c(a,b){if(a=d(a),b=d(b),a.length!=b.length)return"N/D";for(var c=1/a.length,e=o.apply(this,a)/a.length,f=o.apply(this,b)/b.length,g=0,h=0;h<a.length;h++)g+=(a[h]-e)*(b[h]-f);return g*c}function d(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(Array.isArray(d)){for(var e=d,f=e.length;f--;)if("number"==typeof e[f])b.push(e[f]);else if(Array.isArray(e[f]))for(var g=e[f].length;g--;)"number"==typeof e[f][g]&&b.push(e[f][g])}else"number"==typeof d&&b.push(d)}return b}function e(){for(var a=g.apply(this,arguments),b=0,c=0,d=0;d<arguments.length;d++){var e=arguments[d];if(Array.isArray(e))for(var f=e,h=f.length;h--;)for(var i=f[h].length;i--;)null!==f[h][i]&&void 0!==f[h][i]&&(b+=Math.pow(f[h][i]-a,2),c++);else b+=Math.pow(e-a,2),c++}return b/c}function f(a){return Math.pow(Math.E,a)}function g(){return o.apply(this,arguments)/k.apply(this,arguments)}function h(){function a(a){return a.reduce(function(a,b){return a+b})/a.length}var b=d(arguments),c=a(b),e=b.map(function(a){return(a-c)*(a-c)});return Math.sqrt(e.reduce(function(a,b){return a+b})/(b.length-1))}function i(a,b,c){if(0>a||a>1)throw"The probality p must be bigger than 0 and smaller than 1";if(0>c)throw"The standard deviation sigma must be positive";if(0==a)return-(1/0);if(1==a)return 1/0;if(0==c)return b;var d,e,f;return d=a-.5,Math.abs(d)<=.425?(e=.180625-d*d,f=d*(((((((2509.0809287301227*e+33430.57558358813)*e+67265.7709270087)*e+45921.95393154987)*e+13731.69376550946)*e+1971.5909503065513)*e+133.14166789178438)*e+3.3871328727963665)/(((((((5226.495278852854*e+28729.085735721943)*e+39307.89580009271)*e+21213.794301586597)*e+5394.196021424751)*e+687.1870074920579)*e+42.31333070160091)*e+1)):(e=d>0?1-a:a,e=Math.sqrt(-Math.log(e)),5>=e?(e+=-1.6,f=(((((((.0007745450142783414*e+.022723844989269184)*e+.2417807251774506)*e+1.2704582524523684)*e+3.6478483247632045)*e+5.769497221460691)*e+4.630337846156546)*e+1.4234371107496835)/(((((((1.0507500716444169e-9*e+.0005475938084995345)*e+.015198666563616457)*e+.14810397642748008)*e+.6897673349851)*e+1.6763848301838038)*e+2.053191626637759)*e+1)):(e+=-5,f=(((((((2.0103343992922881e-7*e+27115555687434876e-21)*e+.0012426609473880784)*e+.026532189526576124)*e+.29656057182850487)*e+1.7848265399172913)*e+5.463784911164114)*e+6.657904643501103)/(((((((2.0442631033899397e-15*e+1.421511758316446e-7)*e+18463183175100548e-21)*e+.0007868691311456133)*e+.014875361290850615)*e+.1369298809227358)*e+.599832206555888)*e+1)),0>d&&(f=-f)),b+c*f}function j(a,b){var c=-2,d=1,e=0;do{for(var f=(c+d)/2,g=0,h=0;h<a.length;h++){var i=a[h];g+=i[0]/Math.pow(1+f,h)}g>0?(c===d&&(d+=Math.abs(f)),c=f):d=f,e++}while(Math.abs(g)>1e-6&&1e5>e);return f}function k(){for(var a=0,b=arguments.length;b--;){var c=arguments[b];if(Array.isArray(c))for(var d=c,e=d.length;e--;)for(var f=d[e].length;f--;)null!==d[e][f]&&void 0!==d[e][f]&&a++;else null!==c&&void 0!==c&&a++}return a}function l(a,b,c,d,e){if(e=e||0,d=d||0,0!=a){var f=Math.pow(1+a,b);return-(a*(d+f*c))/((-1+f)*(1+a*e))}return 0!=b?-(d+c)/b:0}function m(a,b,c){return a?b:c}function n(){for(var a="",b=0;b<arguments.length;b++)a+=arguments[b];return a}function o(){for(var a=0,b=arguments.length;b--;){var c=arguments[b];if(Array.isArray(c))for(var d=c,e=d.length;e--;)for(var f=d[e].length;f--;)a+=+d[e][f];else a+=+c}return a}function p(){for(var a=null,b=arguments.length;b--;){var c=arguments[b];if(Array.isArray(c))for(var d=c,e=d.length;e--;)a=null==a||a<d[e]?d[e]:a;else isNaN(c)?console.log("WTF??",c):a=null==a||c>a?c:a}return a}function q(){for(var a=null,b=arguments.length;b--;){var c=arguments[b];if(Array.isArray(c))for(var d=c,e=d.length;e--;)a=null==a||a>d[e]?d[e]:a;else isNaN(c)?console.log("WTF??",c):a=null==a||a>c?c:a}return a}function r(a,b,c){for(var d=0;d<b.length;d++)if(b[d][0]==a)return b[d][c-1];throw Error("#N/A")}function s(a,b){b=b||{};var c=b.prefix||"";for(var d in a){var e=a[d];"function"==typeof e?E[c+d]=e:"object"==typeof e&&s(e,t(b,{prefix:d+"."}))}}function t(a,b){var c=JSON.parse(JSON.stringify(a));for(var d in b)c[d]=b[d];return c}function u(a){var b=this;b.name="UserFn",b.args=[],b.calc=function(){return a.apply(b,b.args)},b.push=function(a){b.args.push(a.calc())}}function v(a){this.calc=function(){return a}}function w(a,b){this.calc=function(){var c,d,e;if(-1!=a.indexOf("!")){var f=a.split("!");if(d=b.wb.Sheets[f[0]],!d){var g=f[0].match(/^'(.*)'$/);g&&(f[0]=g[1]),d=b.wb.Sheets[f[0]]}e=f[0],c=f[1]}else d=b.sheet,e=b.sheet_name,c=a;var h=e+"!"+c,i=d[c];if(!i)throw Error("Cell "+h+" not found.");var j=b.formula_ref[h];if(!j)return d[c].v;if("new"===j.status)return B(j),d[c].v;if("working"===j.status)throw new Error("Circular ref");return"done"===j.status?d[c].v:void 0}}function x(a){for(var b=0,c=a.replace(/[0-9]+$/,""),d=c.length;d--;)b+=Math.pow(26,c.length-d-1)*(c.charCodeAt(d)-64);return b-1}function y(a){for(var b,c=a+1,d="",e=10;c>0&&e--;)b=(c-1)%26,d=String.fromCharCode(b+65)+d,c=(c-b-1)/26;return d}function z(a,b){this.calc=function(){var c,d,e;if(-1!=a.indexOf("!")){var f=a.split("!");d=f[0],c=f[1]}else d=b.sheet_name,c=a;e=b.wb.Sheets[d];var g,h=c.split(":"),i=parseInt(h[0].replace(/^[A-Z]+/,""),10)||0,j=h[1].replace(/^[A-Z]+/,"");""===j&&e["!ref"]&&(j=e["!ref"].split(":")[1].replace(/^[A-Z]+/,"")),g=parseInt(""==j?"500000":j,10);for(var k=x(h[0]),l=x(h[1]),m=[],n=i;g>=n;n++){var o=[];m.push(o);for(var p=k;l>=p;p++){var q=y(p)+n,r=d+"!"+q;if(b.formula_ref[r]){if("new"===b.formula_ref[r].status)B(b.formula_ref[r]);else if("working"===b.formula_ref[r].status)throw new Error("Circular ref");o.push(e[q].v)}else e[q]?o.push(e[q].v):o.push(null)}}return m}}function A(a){function b(b,c){for(var e=0;e<d.args.length;e++)if(d.args[e]===b)try{var f=c(d.args[e-1].calc(),d.args[e+1].calc());d.args.splice(e-1,3,new v(f)),e--}catch(g){throw Error(a.name+": evaluating "+a.cell.f+"\n"+g.message)}}function c(){for(var a=d.args.length;a--;)if("-"===d.args[a]){var b=-d.args[a+1].calc();"string"!=typeof d.args[a-1]&&a>0?(d.args.splice(a,1,"+"),d.args.splice(a+1,1,new v(b))):d.args.splice(a,2,new v(b))}}var d=this;d.id=++G,d.args=[],d.name="Expression",d.calc=function(){return c(),b("^",function(a,b){return Math.pow(+a,+b)}),b("*",function(a,b){return+a*+b}),b("/",function(a,b){return+a/+b}),b("+",function(a,b){return+a+ +b}),b("&",function(a,b){return""+a+b}),b("<",function(a,b){return b>a}),b(">",function(a,b){return a>b}),b(">=",function(a,b){return a>=b}),b("<=",function(a,b){return b>=a}),b("<>",function(a,b){return a!=b}),b("=",function(a,b){return a==b}),1==d.args.length?"function"!=typeof d.args[0].calc?d.args[0]:d.args[0].calc():void 0};var e;d.push=function(b){if(b){var c;c=isNaN(b)?"string"==typeof b&&b.trim().replace(/\$/g,"").match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)?new z(b.trim().replace(/\$/g,""),a):"string"==typeof b&&b.trim().replace(/\$/g,"").match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)?new z(b.trim().replace(/\$/g,""),a):"string"==typeof b&&b.trim().replace(/\$/g,"").match(/^[A-Z]+:[A-Z]+$/)?new z(b.trim().replace(/\$/g,""),a):"string"==typeof b&&b.trim().replace(/\$/g,"").match(/^[^!]+![A-Z]+:[A-Z]+$/)?new z(b.trim().replace(/\$/g,""),a):"string"==typeof b&&b.trim().replace(/\$/g,"").match(/^[A-Z]+[0-9]+$/)?new w(b.trim().replace(/\$/g,""),a):"string"==typeof b&&b.trim().replace(/\$/g,"").match(/^[^!]+![A-Z]+[0-9]+$/)?new w(b.trim().replace(/\$/g,""),a):"string"!=typeof b||isNaN(b.trim().replace(/%$/,""))?b:new v(+b.trim().replace(/%$/,"")/100):new v(+b),"="===c&&(">"==e||"<"==e)||"<"==e&&">"===c?d.args[d.args.length-1]+=c:d.args.push(c),e=c}}}function B(a){a.status="working";var b,c=a.cell.f;"="==c[0]&&(c=c.substr(1));for(var d=b=new A(a),e="",f=!1,g=!1,h=[{exp:d}],i=0;i<c.length;i++)if('"'==c[i])f?(d.push(new v(e)),f=!1,g=!0):f=!0,e="";else if(f)e+=c[i];else if("("==c[i]){var j,k=e.trim(),l=E[k];if(l)l=new u(l,a);else if(k)throw new Error('"'+a.sheet_name+'"!'+a.name+": Function "+e+" not found");j=new A(a),h.push({exp:j,special:l}),d=j,e=""}else if(H[c[i]])g||d.push(e),g=!1,d.push(c[i]),e="";else if(","===c[i]&&h[h.length-1].special)g=!1,h[h.length-1].exp.push(e),h[h.length-1].special.push(h[h.length-1].exp),h[h.length-1].exp=d=new A(a),e="";else if(")"==c[i]){var m,n=h.pop();d=n.exp,d.push(e),m=d,e="",d=h[h.length-1].exp,n.special?(n.special.push(m),d.push(n.special)):d.push(m)}else e+=c[i];b.push(e);try{a.cell.v=b.calc(),"string"==typeof a.cell.v?a.cell.t="s":"number"==typeof a.cell.v&&(a.cell.t="n")}catch(o){if("#N/A"!=o.message)throw o;a.cell.v=42,a.cell.t="e",a.cell.w=o.message}finally{a.status="done"}}function C(a){var b={},c=[];for(var d in a.Sheets){var e=a.Sheets[d];for(var f in e)if(e[f].f){var g=b[d+"!"+f]={formula_ref:b,wb:a,sheet:e,sheet_name:d,cell:e[f],name:f,status:"new"};c.push(g)}}return c}function D(a,b,c){var d=a[b];c.noConflict=function(){return a[b]=d,c},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=c),exports[b]=c):a[b]=c,"function"==typeof define&&define.amd&&define(b,[],function(){return c})}var E={FLOOR:Math.floor,"_xlfn.FLOOR.MATH":Math.floor,ABS:Math.abs,SQRT:Math.sqrt,VLOOKUP:r,MAX:p,SUM:o,MIN:q,CONCATENATE:n,IF:m,PMT:l,COUNTA:k,IRR:j,"NORM.INV":i,"_xlfn.NORM.INV":i,STDEV:h,AVERAGE:g,EXP:f,LN:Math.log,"_xlfn.VAR.P":e,"VAR.P":e,"_xlfn.COVARIANCE.P":c,"COVARIANCE.P":c,TRIM:b,LEN:a},F=function(a){for(var b=C(a),c=b.length-1;c>=0;c--)B(b[c])};F.set_fx=function(a,b){E[a]=b},F.exec_fx=function(a,b){return E[a].apply(this,b)},F.col_str_2_int=x,F.int_2_col_str=y,F.import_functions=s;var G=0,H={"*":"multiply","+":"plus","-":"minus","/":"divide","^":"power","&":"concat","<":"lt",">":"gt","=":"eq"};D(this,"XLSX_CALC",F)}).call(this);